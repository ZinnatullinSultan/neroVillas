const express=require("express"),bodyParser=require("body-parser"),axios=require("axios");require("dotenv").config();const app=express(),PORT=process.env.PORT||3e3;app.use(bodyParser.urlencoded({extended:!0})),app.use(bodyParser.json()),app.use(express.static(__dirname)),app.post("/send",((s,e)=>{const{name:t,phone:a,service:r,contact_method:n,email:o}=s.body;if(!/^[a-zA-ZА-Яа-яЁё\s]+$/.test(t))return e.status(400).json({success:!1,message:"Некорректное имя"});if(!/^\+7\d{10}$/.test(a))return e.status(400).json({success:!1,message:"Некорректный номер телефона"});const p=process.env.TELEGRAM_TOKEN,c=process.env.CHAT_ID,d=`https://api.telegram.org/bot${p}/sendMessage`,i=a.replace(/[^\d+]/g,""),u=`Заявка от: ${t}\nТелефон: ${a}\nПочта: ${o}\nТип услуги: ${r}\nТип связи: ${n}\nНаписать в WhatsApp: [WhatsApp](https://wa.me/${i})\n`;axios.post(d,{chat_id:c,text:u,parse_mode:"Markdown"}).then((s=>{e.json({success:!0})})).catch((s=>{e.status(500).json({success:!1})}))})),app.listen(PORT,(()=>{}));